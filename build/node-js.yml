#trigger:
 # - '*' # Run pipeline when a commit is pushed to any branch
  #- 'refs/tags/*' # Run pipeline when a tag is pushed

jobs:
  - job: nodejs
    dependsOn: Build_Queue
    continueOnError: true
    variables:
       myBuildQueue: $[ dependencies.Build_Queue.outputs['setBuildQueue.buildQueue'] ]
    condition: and(succeeded(), contains(dependencies.Build_Queue.outputs['setBuildQueue.buildQueue'], '${{ parameters.solutionFolder }}'))
    pool:
      vmImage: "ubuntu-latest"
    steps:
    - task: NodeTool@0
      inputs:
        versionSpec: '10.x'
      displayName: 'Install Node.js'
    - script: npm install
      displayName: npm install
    #- script: npm run test # If you are using TypeScript
     # displayName: npm run test
    - task: AzureWebApp@1 # https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-rm-web-app?view=azure-devops
      inputs:
        azureSubscription: 'ARM'
        appName: 'testappsvcayo'
        package: $(Build.SourcesDirectory)
        customWebConfig: -Handler iisnode -NodeStartFile app.js -appType node # https://docs.microsoft.com/en-us/azure/devops/pipelines/targets/webapp?view=azure-devops&tabs=yamln
